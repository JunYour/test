<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æˆç»©æ’åè¡¨</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <style>
    body {
      font-family: 'Microsoft YaHei', Arial, sans-serif;
      margin: 10px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      color: #333;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
      background: rgba(255, 255, 255, 0.95);
      border-radius: 15px;
      padding: 15px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
      backdrop-filter: blur(10px);
    }

    h1 {
      text-align: center;
      color: #2c3e50;
      margin-bottom: 20px;
      font-size: 1.5em;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
    }

    .button-container {
      text-align: center;
      margin-bottom: 20px;
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
    }

    button {
      background: linear-gradient(45deg, #4CAF50, #45a049);
      color: white;
      border: none;
      padding: 12px 20px;
      font-size: 14px;
      border-radius: 25px;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(76, 175, 80, 0.3);
      margin: 5px;
      min-width: 120px;
    }

    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(76, 175, 80, 0.4);
    }

    .table-container {
      overflow-x: auto;
      border-radius: 10px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
    }

    table {
      width: 100%;
      border-collapse: collapse;
      background: white;
      border-radius: 10px;
      overflow: hidden;
      min-width: 1200px;
    }

    th,
    td {
      padding: 8px 6px;
      text-align: center;
      border-bottom: 1px solid #eee;
      font-size: 12px;
    }

    th {
      background: linear-gradient(45deg, #667eea, #764ba2);
      color: white;
      font-weight: bold;
      text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
    }

    tr:nth-child(even) {
      background-color: #f8f9fa;
    }

    tr:hover {
      background-color: #e3f2fd;
      transform: scale(1.01);
      transition: all 0.2s ease;
    }

    .rank-1 {
      color: #ff6b35;
      font-weight: bold;
    }

    .rank-2 {
      color: #f7931e;
      font-weight: bold;
    }

    .rank-3 {
      color: #ffcd3c;
      font-weight: bold;
    }

    .stats-container {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 15px;
      margin-top: 20px;
    }

    .stat-card {
      background: linear-gradient(45deg, #ff6b35, #f7931e);
      color: white;
      padding: 15px;
      border-radius: 15px;
      text-align: center;
      box-shadow: 0 8px 25px rgba(255, 107, 53, 0.3);
      transition: transform 0.3s ease;
    }

    .stat-card:hover {
      transform: translateY(-5px);
    }

    .stat-title {
      font-size: 1em;
      margin-bottom: 8px;
      opacity: 0.9;
    }

    .stat-value {
      font-size: 1.5em;
      font-weight: bold;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
    }

    /* ç§»åŠ¨ç«¯é€‚é… */
    @media (max-width: 768px) {
      .container {
        padding: 10px;
        margin: 5px;
      }

      h1 {
        font-size: 1.2em;
        margin-bottom: 15px;
      }

      button {
        padding: 10px 15px;
        font-size: 12px;
        margin: 3px;
        min-width: 100px;
      }

      th,
      td {
        padding: 6px 4px;
        font-size: 10px;
      }

      .table-container {
        font-size: 12px;
      }

      .stats-container {
        grid-template-columns: repeat(2, 1fr);
        gap: 10px;
      }

      .stat-card {
        padding: 12px;
      }

      .stat-title {
        font-size: 0.9em;
      }

      .stat-value {
        font-size: 1.3em;
      }
    }

    /* å°å±å¹•é€‚é… */
    @media (max-width: 480px) {
      .container {
        padding: 8px;
        margin: 2px;
      }

      h1 {
        font-size: 1.1em;
      }

      button {
        padding: 8px 12px;
        font-size: 11px;
        min-width: 80px;
      }

      th,
      td {
        padding: 4px 2px;
        font-size: 9px;
      }

      .stats-container {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>

<body>
  <div class="container">
    <h1>ğŸ“Š é“œä»å¸‚2025å¹´7æœˆé«˜ä¸€å¹´çº§æˆç»©æ’åè¡¨</h1>

  <div class="stats-container" id="statsContainer">
      <div class="stat-card">
        <div class="stat-title">æ€»åˆ†æœ€é«˜</div>
        <div class="stat-value" id="maxTotal">-</div>
      </div>
      <div class="stat-card">
        <div class="stat-title">è¯­æ–‡æœ€é«˜</div>
        <div class="stat-value" id="maxChinese">-</div>
      </div>
      <div class="stat-card">
        <div class="stat-title">æ•°å­¦æœ€é«˜</div>
        <div class="stat-value" id="maxMath">-</div>
      </div>
      <div class="stat-card">
        <div class="stat-title">è‹±è¯­æœ€é«˜</div>
        <div class="stat-value" id="maxEnglish">-</div>
      </div>
      <div class="stat-card">
        <div class="stat-title">æ”¿æ²»æœ€é«˜</div>
        <div class="stat-value" id="maxPolitics">-</div>
      </div>
      <div class="stat-card">
        <div class="stat-title">å†å²æœ€é«˜</div>
        <div class="stat-value" id="maxHistory">-</div>
      </div>
      <div class="stat-card">
        <div class="stat-title">åœ°ç†æœ€é«˜</div>
        <div class="stat-value" id="maxGeography">-</div>
      </div>
      <div class="stat-card">
        <div class="stat-title">å¹³å‡æ€»åˆ†</div>
        <div class="stat-value" id="avgTotal">-</div>
      </div>
    </div>

    <div class="table-container">
      <table id="rankingTable">
        <thead>
          <tr>
            <th>åºå·</th>
            <th>ç­çº§</th>
            <th>æ€»åˆ†</th>
            <th>æ€»åˆ†æ’å</th>
            <th>è¯­æ–‡</th>
            <th>è¯­æ–‡æ’å</th>
            <th>æ•°å­¦</th>
            <th>æ•°å­¦æ’å</th>
            <th>è‹±è¯­</th>
            <th>è‹±è¯­æ’å</th>
            <th>æ”¿æ²»</th>
            <th>æ”¿æ²»æ’å</th>
            <th>å†å²</th>
            <th>å†å²æ’å</th>
            <th>åœ°ç†</th>
            <th>åœ°ç†æ’å</th>
          </tr>
        </thead>
        <tbody id="tableBody">
        </tbody>
      </table>
    </div>

    
  </div>

  <script>
    // åŸå§‹æ•°æ®
    const rawData = [
  ["ç­çº§å››", 391, 81, 53.5, 64, 67, 61.5, 64],
  ["ç­çº§å››", 368.5, 95, 59, 35.5, 39, 82, 58],
  ["ç­çº§å››", 452, 98.5, 65.5, 68.5, 76, 70.5, 73],
  ["ç­çº§å››", 345.5, 88.5, 53, 32.5, 49.5, 54, 68],
  ["ç­çº§å››", 453, 102, 77, 46.5, 72, 74.5, 81],
  ["ç­çº§å››", 431, 84, 66.5, 73, 59.5, 77.5, 70.5],
  ["ç­çº§å››", 363, 76, 46, 53, 43.5, 69.5, 75],
  ["ç­çº§å››", 408, 88, 79, 60.5, 58, 65.5, 57],
  ["ç­çº§å››", 391.5, 79, 77, 51.5, 59, 60, 65],
  ["ç­çº§å››", 326, 76.5, 57, 50.5, 51, 46, 45],
  ["ç­çº§å››", 396, 88, 81, 35.5, 50, 76.5, 65],
  ["ç­çº§å››", 333.5, 80, 67, 38.5, 50.5, 45, 52.5],
  ["ç­çº§å››", 389.5, 84.5, 43.5, 63, 61, 67.5, 70],
  ["ç­çº§å››", 359, 84, 37, 51, 57, 82, 48],
  ["ç­çº§å››", 441, 91.5, 90.5, 87.5, 74.5, 31, 66],
  ["ç­çº§å››", 408.5, 98, 73, 35.5, 60, 68, 74],
  ["ç­çº§å››", 423.5, 89.5, 70, 66, 49.5, 73, 75.5],
  ["ç­çº§å››", 364.5, 77.5, 59, 33, 65, 61.5, 68.5],
  ["ç­çº§å››", 399, 95, 78.5, 36.5, 67, 59, 63],
  ["ç­çº§å››", 332.5, 69.5, 42.5, 46, 64, 44.5, 66],
  ["ç­çº§å››", 376.75, 85.75, 67.5, 32.5, 39, 76, 76],
  ["ç­çº§å››", 381, 92.5, 63, 57.5, 55, 52.5, 60.5],
  ["ç­çº§å››", 360, 93, 40.5, 50, 72, 46, 58.5],
  ["ç­çº§å››", 375.5, 79.5, 52, 38.5, 70.5, 66, 69],
  ["ç­çº§å››", 355, 86.5, 74.5, 30.5, 37, 47.5, 79],
  ["ç­çº§å››", 406.5, 65.5, 70, 65.5, 71.5, 58, 76],
  ["ç­çº§å››", 382, 95.5, 53, 39, 60.5, 72, 62],
  ["ç­çº§å››", 444.5, 84, 89.5, 51, 71.5, 78.5, 70],
  ["ç­çº§å››", 405, 86.5, 66, 54, 61.5, 66, 71],
  ["ç­çº§å››", 358, 78.5, 47, 58.5, 59, 53, 62],
  ["ç­çº§å››", 416.25, 93.75, 67.5, 55.5, 65.5, 68, 66],
  ["ç­çº§å››", 371.5, 87, 64.5, 34.5, 72.5, 51, 62],
  ["ç­çº§å››", 349, 70, 54, 40, 61, 63.5, 60.5],
  ["ç­çº§å››", 337.5, 81, 16, 44.5, 51, 70.5, 74.5],
  ["ç­çº§å››", 363, 79.5, 76, 21.5, 57.5, 65, 63.5],
  ["ç­çº§å››", 309.5, 75.5, 47, 35, 53, 50, 49],
  ["ç­çº§å››", 369, 83.5, 40.5, 45.5, 61, 73.5, 65],
  ["ç­çº§å››", 408, 96.5, 80, 45, 55.5, 79, 52],
  ["ç­çº§å››", 382, 90.5, 44, 33.5, 67.5, 77.5, 69],
  ["ç­çº§å››", 358.5, 79.5, 52, 39, 69, 68.5, 50.5]
];
showStats()
    // å¤„ç†æ•°æ®å¹¶è®¡ç®—æ’å
    function processData() {
      const data = rawData.map((row, index) => ({
        id: index, // æ·»åŠ å”¯ä¸€æ ‡è¯†
        class: row[0],
        total: row[1],
        chinese: row[2],
        math: row[3],
        english: row[4],
        politics: row[5],
        history: row[6],
        geography: row[7]
      }));

      // è®¡ç®—æ€»åˆ†æ’å
      const totalSorted = [...data].sort((a, b) => b.total - a.total);
      totalSorted.forEach((item, index) => {
        const originalItem = data.find(d => d.id === item.id);
        if (originalItem) originalItem.totalRank = index + 1;
      });

      // è®¡ç®—è¯­æ–‡æ’å
      const chineseSorted = [...data].sort((a, b) => b.chinese - a.chinese);
      chineseSorted.forEach((item, index) => {
        const originalItem = data.find(d => d.id === item.id);
        if (originalItem) originalItem.chineseRank = index + 1;
      });

      // è®¡ç®—æ•°å­¦æ’å
      const mathSorted = [...data].sort((a, b) => b.math - a.math);
      mathSorted.forEach((item, index) => {
        const originalItem = data.find(d => d.id === item.id);
        if (originalItem) originalItem.mathRank = index + 1;
      });

      // è®¡ç®—è‹±è¯­æ’å
      const englishSorted = [...data].sort((a, b) => b.english - a.english);
      englishSorted.forEach((item, index) => {
        const originalItem = data.find(d => d.id === item.id);
        if (originalItem) originalItem.englishRank = index + 1;
      });

      // è®¡ç®—æ”¿æ²»æ’å
      const politicsSorted = [...data].sort((a, b) => b.politics - a.politics);
      politicsSorted.forEach((item, index) => {
        const originalItem = data.find(d => d.id === item.id);
        if (originalItem) originalItem.politicsRank = index + 1;
      });

      // è®¡ç®—å†å²æ’å
      const historySorted = [...data].sort((a, b) => b.history - a.history);
      historySorted.forEach((item, index) => {
        const originalItem = data.find(d => d.id === item.id);
        if (originalItem) originalItem.historyRank = index + 1;
      });

      // è®¡ç®—åœ°ç†æ’å
      const geographySorted = [...data].sort((a, b) => b.geography - a.geography);
      geographySorted.forEach((item, index) => {
        const originalItem = data.find(d => d.id === item.id);
        if (originalItem) originalItem.geographyRank = index + 1;
      });

      return data;
    }

    function getRankClass(rank) {
      if (rank === 1) return 'rank-1';
      if (rank === 2) return 'rank-2';
      if (rank === 3) return 'rank-3';
      return '';
    }

    function displayData() {
      const data = processData();
      // æŒ‰æ€»åˆ†æ’åºæ˜¾ç¤º
      const sortedData = [...data].sort((a, b) => b.total - a.total);
      const tbody = document.getElementById('tableBody');
      tbody.innerHTML = '';

      sortedData.forEach((row, index) => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
                    <td class="${getRankClass(index + 1)}">${index + 1}</td>
                    <td>${row.class}</td>
                    <td>${row.total}</td>
                    <td class="${getRankClass(row.totalRank)}">${row.totalRank}</td>
                    <td>${row.chinese}</td>
                    <td class="${getRankClass(row.chineseRank)}">${row.chineseRank}</td>
                    <td>${row.math}</td>
                    <td class="${getRankClass(row.mathRank)}">${row.mathRank}</td>
                    <td>${row.english}</td>
                    <td class="${getRankClass(row.englishRank)}">${row.englishRank}</td>
                    <td>${row.politics}</td>
                    <td class="${getRankClass(row.politicsRank)}">${row.politicsRank}</td>
                    <td>${row.history}</td>
                    <td class="${getRankClass(row.historyRank)}">${row.historyRank}</td>
                    <td>${row.geography}</td>
                    <td class="${getRankClass(row.geographyRank)}">${row.geographyRank}</td>
                `;
        tbody.appendChild(tr);
      });
    }

    function downloadExcel() {
      try {
        // æ£€æŸ¥XLSXåº“æ˜¯å¦åŠ è½½
        if (typeof XLSX === 'undefined') {
          alert('Excelåº“æœªåŠ è½½ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•');
          return;
        }

        const data = processData();
        // æŒ‰æ€»åˆ†æ’åº
        const sortedData = [...data].sort((a, b) => b.total - a.total);
        const ws_data = [
          ['åæ¬¡', 'ç­çº§', 'æ€»åˆ†', 'æ€»åˆ†æ’å', 'è¯­æ–‡', 'è¯­æ–‡æ’å', 'æ•°å­¦', 'æ•°å­¦æ’å', 'è‹±è¯­', 'è‹±è¯­æ’å', 'æ”¿æ²»', 'æ”¿æ²»æ’å', 'å†å²', 'å†å²æ’å', 'åœ°ç†', 'åœ°ç†æ’å']
        ];

        sortedData.forEach((row, index) => {
          ws_data.push([
            index + 1,
            row.class,
            row.total,
            row.totalRank,
            row.chinese,
            row.chineseRank,
            row.math,
            row.mathRank,
            row.english,
            row.englishRank,
            row.politics,
            row.politicsRank,
            row.history,
            row.historyRank,
            row.geography,
            row.geographyRank
          ]);
        });

        const wb = XLSX.utils.book_new();
        const ws = XLSX.utils.aoa_to_sheet(ws_data);

        // è®¾ç½®åˆ—å®½
        ws['!cols'] = [
          { wch: 8 }, { wch: 8 }, { wch: 10 }, { wch: 12 }, { wch: 10 }, { wch: 12 },
          { wch: 10 }, { wch: 12 }, { wch: 10 }, { wch: 12 }, { wch: 10 }, { wch: 12 },
          { wch: 10 }, { wch: 12 }, { wch: 10 }, { wch: 12 }
        ];

        XLSX.utils.book_append_sheet(wb, ws, "æˆç»©æ’åè¡¨");

        // å¤šç§ä¸‹è½½æ–¹å¼å…¼å®¹
        const fileName = "é“œä»å¸‚2025å¹´7æœˆé«˜ä¸€å¹´çº§æˆç»©æ’åè¡¨.xlsx";

        // æ–¹å¼1ï¼šæ ‡å‡†ä¸‹è½½
        try {
          XLSX.writeFile(wb, fileName);
          showMessage('Excelæ–‡ä»¶ä¸‹è½½æˆåŠŸï¼', 'success');
        } catch (e) {
          // æ–¹å¼2ï¼šæ‰‹åŠ¨è§¦å‘ä¸‹è½½
          const wbout = XLSX.write(wb, { bookType: 'xlsx', type: 'binary' });
          const blob = new Blob([s2ab(wbout)], { type: "application/octet-stream" });
          saveAs(blob, fileName);
        }

      } catch (error) {
        console.error('ä¸‹è½½å¤±è´¥:', error);
        showMessage('ä¸‹è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥æµè§ˆå™¨å…¼å®¹æ€§', 'error');
      }
    }

    // è¾…åŠ©å‡½æ•°ï¼šå­—ç¬¦ä¸²è½¬ArrayBuffer
    function s2ab(s) {
      const buf = new ArrayBuffer(s.length);
      const view = new Uint8Array(buf);
      for (let i = 0; i < s.length; i++) view[i] = s.charCodeAt(i) & 0xFF;
      return buf;
    }

    // è¾…åŠ©å‡½æ•°ï¼šæ‰‹åŠ¨ä¿å­˜æ–‡ä»¶
    function saveAs(blob, filename) {
      const link = document.createElement('a');
      if (link.download !== undefined) {
        const url = URL.createObjectURL(blob);
        link.setAttribute('href', url);
        link.setAttribute('download', filename);
        link.style.visibility = 'hidden';
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        URL.revokeObjectURL(url);
        showMessage('Excelæ–‡ä»¶ä¸‹è½½æˆåŠŸï¼', 'success');
      } else {
        showMessage('æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒç›´æ¥ä¸‹è½½ï¼Œè¯·ä½¿ç”¨è¾ƒæ–°ç‰ˆæœ¬çš„æµè§ˆå™¨', 'error');
      }
    }

    // æ˜¾ç¤ºæ¶ˆæ¯æç¤º
    function showMessage(message, type) {
      const messageDiv = document.createElement('div');
      messageDiv.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                padding: 15px 25px;
                border-radius: 8px;
                color: white;
                font-weight: bold;
                z-index: 9999;
                text-align: center;
                ${type === 'success' ? 'background: #4CAF50;' : 'background: #f44336;'}
            `;
      messageDiv.textContent = message;
      document.body.appendChild(messageDiv);

      setTimeout(() => {
        document.body.removeChild(messageDiv);
      }, 3000);
    }

    function showStats() {
      const data = processData();
      const statsContainer = document.getElementById('statsContainer');

      if (statsContainer.style.display === 'none') {
        const maxTotal = Math.max(...data.map(d => d.total));
        const maxChinese = Math.max(...data.map(d => d.chinese));
        const maxMath = Math.max(...data.map(d => d.math));
        const maxEnglish = Math.max(...data.map(d => d.english));
        const maxPolitics = Math.max(...data.map(d => d.politics));
        const maxHistory = Math.max(...data.map(d => d.history));
        const maxGeography = Math.max(...data.map(d => d.geography));
        const avgTotal = (data.reduce((sum, d) => sum + d.total, 0) / data.length).toFixed(1);

        document.getElementById('maxTotal').textContent = maxTotal;
        document.getElementById('maxChinese').textContent = maxChinese;
        document.getElementById('maxMath').textContent = maxMath;
        document.getElementById('maxEnglish').textContent = maxEnglish;
        document.getElementById('maxPolitics').textContent = maxPolitics;
        document.getElementById('maxHistory').textContent = maxHistory;
        document.getElementById('maxGeography').textContent = maxGeography;
        document.getElementById('avgTotal').textContent = avgTotal;

        statsContainer.style.display = 'grid';
      } else {
        statsContainer.style.display = 'none';
      }
    }

    // æ·»åŠ CSVä¸‹è½½åŠŸèƒ½ä½œä¸ºå¤‡é€‰
    function downloadCSV() {
      try {
        const data = processData();
        const sortedData = [...data].sort((a, b) => b.total - a.total);

        let csvContent = "åæ¬¡,ç­çº§,æ€»åˆ†,æ€»åˆ†æ’å,è¯­æ–‡,è¯­æ–‡æ’å,æ•°å­¦,æ•°å­¦æ’å,è‹±è¯­,è‹±è¯­æ’å,æ”¿æ²»,æ”¿æ²»æ’å,å†å²,å†å²æ’å,åœ°ç†,åœ°ç†æ’å\n";

        sortedData.forEach((row, index) => {
          csvContent += `${index + 1},${row.class},${row.total},${row.totalRank},${row.chinese},${row.chineseRank},${row.math},${row.mathRank},${row.english},${row.englishRank},${row.politics},${row.politicsRank},${row.history},${row.historyRank},${row.geography},${row.geographyRank}\n`;
        });

        const blob = new Blob(['\ufeff' + csvContent], { type: 'text/csv;charset=utf-8;' });
        const fileName = "é“œä»å¸‚2025å¹´7æœˆé«˜ä¸€å¹´çº§æˆç»©æ’åè¡¨.csv";

        const link = document.createElement('a');
        if (link.download !== undefined) {
          const url = URL.createObjectURL(blob);
          link.setAttribute('href', url);
          link.setAttribute('download', fileName);
          link.style.visibility = 'hidden';
          document.body.appendChild(link);
          link.click();
          document.body.removeChild(link);
          URL.revokeObjectURL(url);
          showMessage('CSVæ–‡ä»¶ä¸‹è½½æˆåŠŸï¼', 'success');
        } else {
          showMessage('æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒä¸‹è½½åŠŸèƒ½', 'error');
        }
      } catch (error) {
        console.error('CSVä¸‹è½½å¤±è´¥:', error);
        showMessage('CSVä¸‹è½½å¤±è´¥', 'error');
      }
    }

    // åˆå§‹åŒ–æ˜¾ç¤ºæ•°æ®
    displayData();
  </script>
</body>

</html>
